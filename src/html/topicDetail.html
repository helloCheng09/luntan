<!DOCTYPE html>
<html lang="zh_cn">

<head>
    <title>接龙话题</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="../css/topicDetail.css">
    <link rel="stylesheet" href="../js/layui/css/layui.mobile.css">
    <link rel="stylesheet" href="../css/swiper.min.css">
    <script type="text/javascript" src="../js/swiper.min.js"></script>
    <script type="text/javascript" src="../js/layui/layui.all.js"></script>
    <script type="text/javascript" src="../js/zepto.min.js"></script>
    <script type="text/javascript" src="../js/autoTextarae.js"></script>
</head>

<body>
    <!-- 接龙话题详情 -->
    <div id="tDetWrap">
        <!-- <div class="back-box">
            <span class="right-item">
                <div class="item-img">
                    <div class="home-text">接龙列表</div>
                </div>
            </span>
        </div> -->
        <div class="topic-det" topic-id="1">
            <div class="head-det">
                <div class="avatar-img">
                    <img src="https://wx3.sinaimg.cn/large/65e195cdgy1fwiib1cou5j20qo0xc7pw.jpg" alt="" class="avatar">
                </div>
                <div class="right-item">
                    <div class="nick-name"><em class="pre-icon">校</em><em class="xz-text">校长昵称</em></div>
                    <div class="ft-time">发布时间：2018-10-24</div>
                </div>
            </div>

            <!-- 百度编辑后 正文内容 -->
            <div class="topic-contain">
                <p> 这是正文正文这是正文正文这是正文正文这是正文正文</p>
                <p>
                    <img src="https://wx3.sinaimg.cn/large/65e195cdgy1fwix6velmhj218w0u0wz0.jpg" alt="">
                    <img src="https://wx3.sinaimg.cn/large/65e195cdgy1fwiib1cou5j20qo0xc7pw.jpg" alt="">
                    <img src="https://gss0.bdstatic.com/7051cy89RcgCncy6lo7D0j9wexYrbOWh7c50/HW.png?t=1540718085" alt="">
                </p>
            </div>

            <!-- 图片组最大化 -->
            <div class="main-max-list" id="showPanel" style="display:none;">
                <div class="swiper-wrapper" id="showConMax"></div>
            </div>

        </div>

        <div class="comment-list">
            <div class="top-tags">
                <a href="./topicList.html" class="link-list">
                    <label>返回接龙列表</label>
                </a>
                <span class="com-tag checked" id="comTag">评论：666</span>
                <span class="like-tag" id="likeTag" like-status='1'>
                    <div class="item-r">
                        <span style="display: none;" id="topicLike" class="zanicon-box">
                            <span class="zanicon" style="background-image:url(../img/likes.png)"></span>
                        </span>
                    </div>
                    赞：<span class="like-topic-sum">2</span>
                </span>
            </div>
            <div class="com-main">
                <!-- 评论列表 -->
                <ul class="com-list">
                    <li class="com-item" data-id="1">
                        <span class="left-avatar">
                            <img src="https://ww4.sinaimg.cn/orj480/0062Mr4Vjw8epo890ks01j30f00f00tt.jpg" class="img"
                                alt="">
                        </span>
                        <span class="right-detail">
                            <div class="nick-box">
                                <div class="nick">学生家长1</div>
                                <div class="student-parent">绑定的学生：xxxxxxx</div>
                            </div>
                            <div class="comment-panel">
                                <div class="com-text">这是评论内容这是评论内容这是评论内容这是评论内容这是评论内容这是评论内容</div>
                                <ul class="img-list">
                                    <li class="comment-img-box">
                                        <div class="img-conten">
                                            <div class="show-img" style="background-image:url(../img/banner.jpg)"></div>
                                        </div>
                                        <div class="img-max-box" style="display:none;">
                                            <img class="show-max" src="../img/banner.jpg">
                                        </div>
                                    </li>
                                </ul>
                            </div>
                            <!-- 子评论链接 -->
                            <div class="zi-com">
                                <a href="./commentDetail.html" class="zi-link">
                                    <div class="zi-com-item">
                                        <span class="zi-author">家长2：</span>
                                        <span class="zi-com-text">评论的评论</span>
                                    </div>
                                    <div class="zi-com-item">
                                        <span class="zi-author">家长2</span><em>回复</em><span class="zi-author">家长66：</span>
                                        <span class="zi-com-text">评论的评论</span>
                                    </div>
                                    <div class="show-all-zi">共8条评论 ></div>
                                </a>
                            </div>
                            <div class="com-item-bottom">
                                <span class="com-time">9分钟前</span>
                                <div class="like-com">
                                    <em class="com-com">
                                        <a href="./commentDetail.html">
                                            <img src="../img/pinglun.png" alt="" class="com-im">
                                        </a>
                                    </em>
                                    <em class="com-like" like-status="1" style="background-image: url(../img/likes.png);"></em><em
                                        class="like-num">88</em>
                                </div>
                            </div>
                        </span>
                    </li>
                    <li class="com-item" data-id="1">
                        <span class="left-avatar">
                            <img src="https://ww4.sinaimg.cn/orj480/0062Mr4Vjw8epo890ks01j30f00f00tt.jpg" class="img"
                                alt="">
                        </span>
                        <span class="right-detail">
                            <div class="nick-box">
                                <div class="nick">学生家长1</div>
                                <div class="student-parent">绑定的学生：xxxxxxx</div>
                            </div>
                            <div class="com-text">这是评论内容</div>
                            <!-- 子评论链接 -->
                            <div class="zi-com">
                                <a href="./commentDetail.html" class="zi-link">
                                    <div class="zi-com-item">
                                        <span class="zi-author">家长2：</span>
                                        <span class="zi-com-text">评论的评论评论的评论评论的评论评论的评论</span>
                                    </div>
                                    <div class="zi-com-item">
                                        <span class="zi-author">家长2</span><em>回复</em><span class="zi-author">家长66：</span>
                                        <span class="zi-com-text">评论的评论</span>
                                    </div>
                                    <div class="show-all-zi">共8条评论 ></div>
                                </a>
                            </div>
                            <div class="com-item-bottom">
                                <span class="com-time">9分钟前</span>
                                <div class="like-com">
                                    <em class="com-com">
                                        <a href="./commentDetail.html">
                                            <img src="../img/pinglun.png" alt="" class="com-im">
                                        </a>
                                    </em>
                                    <em class="com-like" like-status="0" style="background-image: url(../img/likes.png);"></em><em
                                        class="like-num">66</em>
                                </div>
                            </div>
                        </span>
                    </li>
                </ul>
                <!-- 点赞列表 -->
                <ul class="like-list" style="display:none;">
                    <li class="like-item">
                        <div class="item-l">
                            <div class="avatar-img">
                                <img src="https://ww4.sinaimg.cn/orj480/0062Mr4Vjw8epo890ks01j30f00f00tt.jpg" class="img"
                                    alt="">
                            </div>
                            <span class="like-det-right">
                                <div class="nick-name">家长1</div>
                                <div class="student-parent">绑定的学生：xxxxxxx</div>
                            </span>
                        </div>
                        <div class="item-r">
                            <span class="zanicon-box">
                                <span class="zanicon" style="background-image:url(../img/likes.png)"></span>
                            </span>
                            <span class="zan-text">赞</span>
                        </div>
                    </li>
                </ul>
            </div>
            <!-- 回复评论 -->
            <!-- <div class="hid-re-com" style="display:none;">
                <div class="re-com-panel">
                    <div class="re-com">回复</div>
                    <div class="re-cancle">取消</div>
                </div>
            </div> -->
            <!-- 提交回复话题 表单  -->
            <div class="hid-form" id="subForm_1" style="display:none;">
                <div class="blank-close"></div>
                <form action="">
                    <div class="text-box">
                        <textarea name="comment" id="" placeholder="回复接龙话题"></textarea>
                    </div>
                    <!-- 增加图片评论 -->

                    <div class="img-input-box">
                        <ul id="imgInput">
                            <li class="add-input-img" style="background-image: url(../img/addimg.png);">
                                <input id="file" class="add-input-img" onchange="getSrc(this)" style="opacity: 0;background-image: url(../img/addimg.png);"
                                    class="filepath" type="file">
                            </li>
                        </ul>
                    </div>
                    <div class="submit-btn">
                        <!-- <span class="face-btn">
                                <img src="./img/face.png" alt="">
                            </span> -->
                        <span class="fasong-btn">
                            <input type="submit" id="submitBtn" value="发送回复">
                        </span>
                    </div>

            </div>

            <!-- 提交回复评论 表单  -->
            <div class="hid-re-form" id="subForm_2" style="display:none;">
                <div class="blank-close"></div>
                <form action="" enctype="multipart/form-data">
                    <div class="text-box">
                        <textarea name="comment" id="" placeholder="回复接龙评论"></textarea>
                    </div>
                    <div class="submit-btn">
                        <!-- <span class="face-btn">
                                <img src="./img/face.png" alt="">
                            </span> -->
                        <span class="fasong-btn">
                            <input type="submit" id="submitBtn" value="发送回复">
                            <!-- <input type="button" id="submitBtn" value="取消"> -->
                        </span>
                    </div>
                </form>
            </div>

            <!-- 回复接龙话题 -->
            <footer class="com-topic">
                <span class="footer-btn">
                    <div class="com-this-topic" id="comThis">回复接龙</div>
                </span>
                <span class="footer-btn dianzan_topic">
                    <em class="like-btn-show">点赞接龙</em>
                </span>
            </footer>
        </div>
    </div>

    <!-- 渲染 -->
    <script src="../js/render.js" type="text/javascript"></script>
    <!-- 获取数据 -->
    <script src="../js/getData.js" type="text/javascript"></script>
    <!-- 点击事件 -->
    <script src="../js/click.js" type="text/javascript"></script>
    <!-- 主入口js -->
    <script src="../js/index.js" type="text/javascript"></script>

    <script>
        // 获取图片地址
        function getSrc() {
            let reads = new FileReader();
            let url
            f = document.getElementById('file').files[0];
            reads.readAsDataURL(f);
            reads.onload = function (e) {
                url = this.result
                // 渲染
                // 传输给后台
                pushData(url)
                renderComImg(url)
            };
        }

        function pushData(img) {
            let data = img
            let dataImg = $('#formImg').serialize()
            $.ajax({
                url: 'http://www.mamawozaizhe.com/yz/mobile2/jielong/do_upload',
                type: 'POST',
                data: dataImg,
                dataType: 'JSON',
                success: getPicUrl(data),
            })
        }


        function getPicUrl(data, code) {
            console.log(data)
            console.log(code)
        }


        function renderComImg(url) {
            let img_num = $("#imgInput").find(".img-input-item").length + 1
            console.log(img_num)

            let html =
                `
                    <li class="img-input-item" img-id="${img_num}">
                        <em class="delet" style="background-image:url(../img/deletimg.png)"></em>
                        <div class="img-con" style="background-image:url(${url})"></div>
                        <div class="img-max-box">
                            <img class="show-max" src="${url}">
                        </div>
                    </li>
                `
            $("#imgInput").append(html)
            // 删除
            deletImg()
            // 放大
            maxImg()

            // 超过4张不显示
            root.showUpload()
        }

        function deletImg() {
            $(".img-input-item").each(function () {
                let ele = $(this)
                $(this).find(".delet").on("click", function () {
                    ele.remove()
                    console.log("删除图片")
                    // 超过4张不显示
                    root.showUpload()
                })
            })
        }

        function maxImg() {
            $(".img-input-item").each(function () {
                let ele = $(this)
                $(this).on("click", function () {
                    ele.find(".img-max-box").css("display", "flex")
                    closeScan()
                })
            })
        }


        // 关闭最大化
        function closeScan() {
            $(".show-max").on("click", function () {
                $(".img-max-box").css("display", "none")
                console.log(12314)
                return false
            })

        }
    </script>


</body>

</html>